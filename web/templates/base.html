<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Image Uploader</title>
    <script src="https://unpkg.com/htmx.org@1.9.9"></script>
    <link rel="stylesheet" href="public/index.css" />
    <script>
      function handleDragOver(e) {
        e.preventDefault();
      }

      async function handleDrop(e) {
        e.preventDefault();

        const formData = new FormData();
        formData.append("image", e.dataTransfer.files[0]);
        const response = await fetch("/upload", {
          method: "POST",
          body: formData,
        });

        const html = await response.text();
        document.getElementById("content").innerHTML = html;
      }
    </script>
  </head>
  <body>
    <div class="mx-auto w-[720px] p-4 shadow-lg" id="content">
      <div id="loader">
        <p class="mb-10">Uploading...</p>
        <div class="h-4 rounded-lg bg-gray-100">
          <div id="bar" class="h-full w-0 rounded-lg bg-blue-500"></div>
          <script>
            let percent = 0;
            setInterval(() => {
              percent += 10;

              if (percent > 100) {
                percent = 0;
              }

              document.getElementById("bar").style.width = `${percent}%`;
            }, 1000);
          </script>
        </div>
      </div>
      <div
        id="dnd"
        class="rounded-lg border-2 border-dashed border-blue-300 bg-gray-100 py-10 text-center"
        ondragover="handleDragOver(event)"
        ondrop="handleDrop(event)"
      >
        <img src="public/image.svg" alt="image" class="inline-block" />
        <p class="mt-10 text-gray-400">Drag & Drop your image here</p>
      </div>
      <p class="my-10 text-center text-gray-400">Or</p>
      <div class="text-center">
        <label
          for="image"
          class="inline-block cursor-pointer rounded-lg bg-blue-500 px-4 py-2 text-white"
        >
          Choose a file
          <input
            class="hidden"
            id="image"
            type="file"
            name="image"
            accept="image/png,image/jpeg,image/jpg"
            hx-post="/upload"
            hx-encoding="multipart/form-data"
            hx-swap="outerHTML"
          />
        </label>
      </div>
    </div>
  </body>
</html>
